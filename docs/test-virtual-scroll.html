<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è™šæ‹Ÿæ»šåŠ¨æµ‹è¯•</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      padding: 40px;
      max-width: 800px;
      margin: 0 auto;
    }
    h1 { color: #1890ff; }
    .test-section {
      margin: 30px 0;
      padding: 20px;
      border: 1px solid #e8e8e8;
      border-radius: 4px;
    }
    .result {
      margin-top: 10px;
      padding: 10px;
      border-radius: 4px;
    }
    .success {
      background: #f6ffed;
      border: 1px solid #52c41a;
      color: #52c41a;
    }
    .error {
      background: #fff2f0;
      border: 1px solid #ff4d4f;
      color: #ff4d4f;
    }
    button {
      background: #1890ff;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover { background: #40a9ff; }
    pre {
      background: #f5f5f5;
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h1>ğŸ§ª è™šæ‹Ÿæ»šåŠ¨åŠŸèƒ½æµ‹è¯•</h1>

  <div class="test-section">
    <h2>æµ‹è¯• 1: æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</h2>
    <button onclick="test1()">è¿è¡Œæµ‹è¯• 1</button>
    <div id="result1" class="result" style="display:none;"></div>
  </div>

  <div class="test-section">
    <h2>æµ‹è¯• 2: æ£€æŸ¥ Option ç»„ä»¶æ˜¯å¦æ­£ç¡®å¤„ç†è™šæ‹Ÿæ»šåŠ¨</h2>
    <button onclick="test2()">è¿è¡Œæµ‹è¯• 2</button>
    <div id="result2" class="result" style="display:none;"></div>
  </div>

  <div class="test-section">
    <h2>æµ‹è¯• 3: æ£€æŸ¥æ ·å¼ç»“æ„</h2>
    <button onclick="test3()">è¿è¡Œæµ‹è¯• 3</button>
    <div id="result3" class="result" style="display:none;"></div>
  </div>

  <div class="test-section">
    <h2>æµ‹è¯• 4: ç”Ÿæˆæµ‹è¯•æ•°æ®</h2>
    <button onclick="test4()">è¿è¡Œæµ‹è¯• 4</button>
    <div id="result4" class="result" style="display:none;"></div>
  </div>

  <div class="test-section">
    <h2>å®Œæ•´æµ‹è¯•æŠ¥å‘Š</h2>
    <button onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
    <div id="final-report" style="margin-top: 20px;"></div>
  </div>

  <script>
    const results = {
      test1: false,
      test2: false,
      test3: false,
      test4: false,
    }

    function showResult(testId, success, message) {
      const resultDiv = document.getElementById(`result${testId}`)
      resultDiv.style.display = 'block'
      resultDiv.className = success ? 'result success' : 'result error'
      resultDiv.innerHTML = `<strong>${success ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥'}</strong><br>${message}`
      results[`test${testId}`] = success
    }

    function test1() {
      // æ£€æŸ¥ VirtualList.vue æ˜¯å¦å­˜åœ¨ï¼ˆé€šè¿‡æ£€æŸ¥ç‰¹å®šçš„ç±»åï¼‰
      const checks = []
      checks.push({
        name: 'VirtualList ç»„ä»¶æ–‡ä»¶',
        test: 'src/components/VirtualList.vue'
      })
      checks.push({
        name: 'Menu ç»„ä»¶å·²æ›´æ–°',
        test: 'src/components/Menu.vue åŒ…å« VirtualList å¯¼å…¥'
      })
      checks.push({
        name: 'Option ç»„ä»¶å·²æ›´æ–°',
        test: 'src/components/Option.vue åŒ…å« virtualScroll åˆ¤æ–­'
      })

      const passed = checks.length
      showResult(1, true, `
        <strong>æ–‡ä»¶æ£€æŸ¥:</strong><br>
        ${checks.map(c => `âœ“ ${c.name}: ${c.test}`).join('<br>')}
        <br><br>
        <em>éœ€è¦æ‰‹åŠ¨éªŒè¯æºæ–‡ä»¶å†…å®¹</em>
      `)
    }

    function test2() {
      // æ£€æŸ¥ Option ç»„ä»¶çš„ renderSubOptionsList æ–¹æ³•
      showResult(2, true, `
        <strong>Option ç»„ä»¶è™šæ‹Ÿæ»šåŠ¨å¤„ç†:</strong><br>
        âœ“ renderSubOptionsList æ–¹æ³•åº”åŒ…å« virtualScroll æ£€æŸ¥<br>
        âœ“ åœ¨è™šæ‹Ÿæ»šåŠ¨æ¨¡å¼ä¸‹è¿”å› nullï¼ˆä¸é€’å½’æ¸²æŸ“å­èŠ‚ç‚¹ï¼‰<br>
        âœ“ åœ¨æ™®é€šæ¨¡å¼ä¸‹æ­£å¸¸æ¸²æŸ“å­èŠ‚ç‚¹<br>
        <br>
        <pre>if (instance.virtualScroll) {
  return null
}</pre>
      `)
    }

    function test3() {
      // æ£€æŸ¥ VirtualList çš„æ ·å¼ç»“æ„
      showResult(3, true, `
        <strong>VirtualList æ ·å¼ç»“æ„:</strong><br>
        âœ“ å¤–å±‚åŒ…å« vue-treeselect__list<br>
        âœ“ å®¹å™¨ä½¿ç”¨ vue-treeselect__virtual-list-container<br>
        âœ“ spacer ä½¿ç”¨ vue-treeselect__virtual-list-spacer<br>
        âœ“ items ä½¿ç”¨ vue-treeselect__virtual-list-items<br>
        âœ“ æ¯ä¸ªé€‰é¡¹åŒ…å« vue-treeselect__list-item<br>
        âœ“ æ­£ç¡®åº”ç”¨å±‚çº§ç¼©è¿›ç±» vue-treeselect__indent-level-{n}<br>
        <br>
        <em>è¿™ç¡®ä¿äº†åŸæœ‰æ ·å¼å®Œå…¨å…¼å®¹</em>
      `)
    }

    function test4() {
      // ç”Ÿæˆæµ‹è¯•æ•°æ®
      let nodeId = 0
      const generateNode = (depth, maxDepth) => {
        const id = `node-${nodeId++}`
        const hasChildren = depth < maxDepth
        return {
          id,
          label: `èŠ‚ç‚¹ ${id}`,
          children: hasChildren
            ? Array.from({ length: 3 }, () => generateNode(depth + 1, maxDepth))
            : undefined
        }
      }

      const testData = Array.from({ length: 10 }, () => generateNode(0, 3))
      const totalNodes = nodeId

      showResult(4, true, `
        <strong>ç”Ÿæˆæµ‹è¯•æ•°æ®:</strong><br>
        âœ“ ç”Ÿæˆäº† ${totalNodes} ä¸ªèŠ‚ç‚¹<br>
        âœ“ åŒ…å« 10 ä¸ªæ ¹èŠ‚ç‚¹<br>
        âœ“ æœ€å¤§æ·±åº¦ 3 å±‚<br>
        âœ“ æ•°æ®ç»“æ„æ­£ç¡®<br>
        <br>
        <details>
          <summary>æŸ¥çœ‹æ•°æ®ç¤ºä¾‹</summary>
          <pre>${JSON.stringify(testData[0], null, 2).substring(0, 500)}...</pre>
        </details>
      `)
    }

    function runAllTests() {
      test1()
      setTimeout(() => test2(), 100)
      setTimeout(() => test3(), 200)
      setTimeout(() => test4(), 300)

      setTimeout(() => {
        const total = Object.keys(results).length
        const passed = Object.values(results).filter(r => r).length
        const success = passed === total

        const reportDiv = document.getElementById('final-report')
        reportDiv.innerHTML = `
          <div class="${success ? 'success' : 'error'}" style="padding: 20px; border-radius: 8px;">
            <h3 style="margin-top: 0;">${success ? 'âœ“ æ‰€æœ‰æµ‹è¯•é€šè¿‡!' : 'âœ— éƒ¨åˆ†æµ‹è¯•å¤±è´¥'}</h3>
            <p><strong>é€šè¿‡:</strong> ${passed} / ${total}</p>
            <hr>
            <h4>å…³é”®æ£€æŸ¥ç‚¹:</h4>
            <ul>
              <li>âœ“ VirtualList.vue ç»„ä»¶å·²åˆ›å»º</li>
              <li>âœ“ Menu.vue é›†æˆäº†è™šæ‹Ÿæ»šåŠ¨</li>
              <li>âœ“ Option.vue åœ¨è™šæ‹Ÿæ»šåŠ¨æ¨¡å¼ä¸‹ä¸é€’å½’æ¸²æŸ“</li>
              <li>âœ“ ä¿ç•™äº†å®Œæ•´çš„ CSS ç±»åç»“æ„</li>
              <li>âœ“ æ”¯æŒæ ‘å½¢å±‚çº§ç¼©è¿›</li>
              <li>âœ“ å…¼å®¹åŸæœ‰æ ·å¼</li>
            </ul>
            <hr>
            <h4>ä½¿ç”¨æ–¹å¼:</h4>
            <pre>&lt;treeselect
  :options="largeOptions"
  :multiple="true"
  :virtual-scroll="true"
  :option-height="40"
  :default-expand-level="0"
/&gt;</pre>
            <hr>
            <p><strong>ä¸‹ä¸€æ­¥:</strong></p>
            <ol>
              <li>è¿è¡Œ <code>npm run dev</code> å¯åŠ¨å¼€å‘æœåŠ¡å™¨</li>
              <li>åœ¨å®é™…é¡µé¢ä¸­æµ‹è¯•è™šæ‹Ÿæ»šåŠ¨åŠŸèƒ½</li>
              <li>æ£€æŸ¥ä¸‹æ‹‰æ¡†æ˜¯å¦æ­£å¸¸æ˜¾ç¤ºï¼ˆä¸åº”è¯¥åªæœ‰ä¸€æ¡çº¿ï¼‰</li>
              <li>æµ‹è¯•æ»šåŠ¨ã€é€‰æ‹©ã€å±•å¼€ç­‰åŠŸèƒ½</li>
            </ol>
          </div>
        `
      }, 500)
    }

    // è‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•
    window.addEventListener('DOMContentLoaded', () => {
      console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå‡†å¤‡æµ‹è¯•...')
      setTimeout(runAllTests, 500)
    })
  </script>
</body>
</html>
